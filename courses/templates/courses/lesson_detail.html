{% extends 'core/layout.html' %}
{% load static %}

{% block title %} {{lesson.title}} {% endblock %}
{% block style %} {% static "courses/css/style.css" %} {% endblock %}

{% block content %}
    <div class="row">
        <div class="col-md-3">
            <div class="list-group sticky-top">
            <div class="list-group-item active">–ù–∞–≤–∏–≥–∞—Ü–∏—è</div>
            {% for module in modules %}
                <div class="list-group-item fw-bold">{{ module.title }}</div>
                {% for l in module.lessons.all %}
                {% if l.id in allowed_ids %}
                    <a href="{% url 'courses:lesson_progress' l.id %}" class="list-group-item {% if l.id == lesson.id %}active{% endif %}">
                    {{ l.title }}
                    {% if l.id in completed_lesson_ids %}
                        <span class="badge bg-success float-end">‚úî</span>
                    {% endif %}
                    </a>
                {% else %}
                    <div class="list-group-item disabled text-muted">{{ l.title }} üîí</div>
                {% endif %}
                {% endfor %}
            {% endfor %}
            </div>
        </div>

        <div class="col-md-9">
            <div class="d-flex justify-content-center align-items-center" style="height: 100px;">
                <h2 >{{ lesson.title }}</h2>
            </div>


            <div class="card mx-auto" style="overflow: hidden; width: 70%;">
                <div class="card-body">
                    <p class="card-text ">{{ lesson.description|safe }}</p>
                </div>
            </div>

            {% for material in lesson.materials.all %}
                <div class="card mb-3">
                    <div class="card-body">
                    <h5>{{ material.title }}</h5>
                    {% if material.material_type == 'text' %}
                        <p>{{ material.content|safe }}</p>
                    {% elif material.material_type == 'video' %}
                        <iframe src="{{ material.video_url }}" width="100%" height="400"></iframe>
                    {% elif material.material_type == 'image' %}
                        <img src="{{ material.file.url }}" class="img-fluid">
                    {% elif material.file %}
                        <a href="{{ material.file.url }}" download>–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</a>
                    {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

{% endblock %}